# KMS.5: KMS keys should not be publicly accessible

let resource_type = "AWS::KMS::Key"

rule kms_key_public_access when resource_type {
  Resources.*[ Type == resource_type ] {
    Properties.KeyPolicy.Statement[*] {
      Effect == "Allow"
      Principal == "*"
      Action[*] == "kms:Encrypt"
    }
  }
}
