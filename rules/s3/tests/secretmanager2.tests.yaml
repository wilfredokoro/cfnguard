- name: Secret rotates successfully, PASS
  input:
    Resources:
      MySecret:
        Type: AWS::SecretsManager::Secret
        Properties:
          RotationRules:
            AutomaticallyAfterDays: 30
        Metadata:
          RotationOccurringAsScheduled: true
  expectations:
    rules:
      SECRETS_ROTATE_SUCCESSFULLY: PASS


- name: Secret not rotating as scheduled, FAIL
  input:
    Resources:
      MySecret:
        Type: AWS::SecretsManager::Secret
        Properties:
          RotationRules:
            AutomaticallyAfterDays: 30
        Metadata:
          RotationOccurringAsScheduled: false
  expectations:
    rules:
      SECRETS_ROTATE_SUCCESSFULLY: FAIL
