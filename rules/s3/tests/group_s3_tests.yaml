---
- name: Aurora MySQL with audit logs
  input:
    Resources:
      MyDBCluster:
        Type: AWS::RDS::DBCluster
        Properties:
          Engine: aurora-mysql
          EnableCloudwatchLogsExports:
            - audit
            - error
  expectations:
    rules:
      RDS_AURORA_MYSQL_AUDIT_LOGGING_ENABLED: PASS

- name: Aurora MySQL without audit logs
  input:
    Resources:
      MyDBCluster:
        Type: AWS::RDS::DBCluster
        Properties:
          Engine: aurora-mysql
          EnableCloudwatchLogsExports:
            - error
  expectations:
    rules:
      RDS_AURORA_MYSQL_AUDIT_LOGGING_ENABLED: FAIL

- name: Non-MySQL cluster
  input:
    Resources:
      MyDBCluster:
        Type: AWS::RDS::DBCluster
        Properties:
          Engine: postgres
  expectations:
    rules:
      RDS_AURORA_MYSQL_AUDIT_LOGGING_ENABLED: SKIP